CREATE TABLE foo AS SELECT 'bar'::text AS t;
BEGIN; SET duckdb.force_execution = true; SELECT t::integer AS t1 FROM foo; ROLLBACK;
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Could not convert string 'bar' to INT32 when casting from source column t

LINE 1:  SELECT (t)::integer AS t1 FROM pgduckdb.public.foo
                   ^
SET duckdb.force_execution = true;
SELECT 1 FROM foo;
 ?column? 
----------
        1
(1 row)

-- Make sure we query the cache during a valid TX
DROP EXTENSION IF EXISTS pg_duckdb CASCADE;
NOTICE:  drop cascades to 22 other objects
DETAIL:  drop cascades to table ducklake.ducklake_metadata
drop cascades to table ducklake.ducklake_snapshot
drop cascades to table ducklake.ducklake_snapshot_changes
drop cascades to table ducklake.ducklake_schema
drop cascades to table ducklake.ducklake_table
drop cascades to table ducklake.ducklake_view
drop cascades to table ducklake.ducklake_tag
drop cascades to table ducklake.ducklake_column_tag
drop cascades to table ducklake.ducklake_data_file
drop cascades to table ducklake.ducklake_file_column_stats
drop cascades to table ducklake.ducklake_delete_file
drop cascades to table ducklake.ducklake_column
drop cascades to table ducklake.ducklake_table_stats
drop cascades to table ducklake.ducklake_table_column_stats
drop cascades to table ducklake.ducklake_partition_info
drop cascades to table ducklake.ducklake_partition_column
drop cascades to table ducklake.ducklake_file_partition_value
drop cascades to table ducklake.ducklake_files_scheduled_for_deletion
drop cascades to table ducklake.ducklake_inlined_data_tables
drop cascades to table ducklake.ducklake_column_mapping
drop cascades to table ducklake.ducklake_name_mapping
drop cascades to table ducklake.ducklake_schema_versions
BEGIN;
CREATE EXTENSION pg_duckdb;
SELECT * FROM do_not_exist;
ERROR:  relation "do_not_exist" does not exist
LINE 1: SELECT * FROM do_not_exist;
                      ^
END;
CREATE EXTENSION pg_duckdb;
