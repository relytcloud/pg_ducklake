-- Test for INSERT ... UNNEST
CREATE TABLE insert_unnest (
    id INT
) USING ducklake;
INSERT INTO insert_unnest
SELECT * FROM UNNEST(ARRAY[1, 2, 3]);
SELECT * FROM insert_unnest ORDER BY id;
 id 
----
  1
  2
  3
(3 rows)

DROP TABLE insert_unnest;
CREATE TABLE insert_unnest (
    id INT,
    val TEXT
) USING ducklake;
-- Test 1: Multi-argument UNNEST (zipping)
INSERT INTO insert_unnest
SELECT * FROM UNNEST(ARRAY[1, 2, 3], ARRAY['a', 'b', 'c']);
SELECT * FROM insert_unnest ORDER BY id;
 id | val 
----+-----
  1 | a
  2 | b
  3 | c
(3 rows)

-- Test 2: Array Literal Handling
INSERT INTO insert_unnest
SELECT * FROM UNNEST(ARRAY[4, 5], ARRAY['d', 'e']::text[]);
SELECT * FROM insert_unnest WHERE id > 3 ORDER BY id;
 id | val 
----+-----
  4 | d
  5 | e
(2 rows)

-- Clean up
DROP TABLE insert_unnest;
